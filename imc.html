<!Doctype html>
<html>
<title>Javascript</title>
<meta charset="UTF-8">

<script>

	/**
	*	Programme de calcul de l'IMC d'une personne
	*   avec un code Javascript
	*   Auteur: Marc Harnist
	*   Lieu: ENI Niort
	*   Date: 2019-07-05
	**/

	// Les variables globales
	var poids = 0;
	var taille = 0;
	var imc = 0;
</script>
<body>

	<h1>Calcul IMC</h1>

	<p>Votre poids: <input type="text" id="poids" value="98"></p>
	<p>Votre taille en cm: <input type="text" id="taille" value="180"></p>

	<p><button onclick="calculer()">Calculer</button></p>

	<h2>Résultat: <span id="resultat"></span></h2>
	<h3 id="message"></h3>

	<script type="text/javascript">

	var id1 = "poids";
	var id2 = "taille";
	var id3 = "resultat";
	var id4 = "message";
	var message = "";
	
	function calculer() {
	
		var insuffisancePonderale = "\"insuffisance pondérale\"";
		var corpulenceNormale = "\"corpulence normale\"";
		var surpoids = "\"surpoids\"";
		var obesiteModeree = "\"obésité modérée\"";
		var obesiteSevere = "\"obésité sévère\"";
		var obesiteMorbideOuMassive = "\"obésité morbide ou massive\"";
		
	
		selector1 = document.getElementById(id1);
		selector2 = document.getElementById(id2);
		selector3 = document.getElementById(id3);
		selector4 = document.getElementById(id4);
		poids  = selector1.value;
		taille = selector2.value/100;
		imc = poids/(taille*taille);
		imcBrut = imc;
		arrondi = Math.round(imc*10);
		imc = arrondi/10;

		/*
		Indice de masse corporelle (IMC)	Interprétation (d'après l'OMS)
		moins de 18,5	Insuffisance pondérale (maigreur)
		18,5 à 25	Corpulence normale
		25 à 30	Surpoids
		30 à 35	Obésité modérée
		35 à 40	Obésité sévère
		plus de 40	Obésité morbide ou massive
		*/
		if(imc<18.5){
			message = "";
		
			//Calcul de la différence avec la catégorie en-dessous
			var bonImc = 18.5;
			var ecart = bonImc-imcBrut;
			var meilleurPoids = Math.round(bonImc*taille*taille);
			var prochaineCategorie = "corpulence normale";
			message = "Vous êtes en " + insuffisancePonderale +  ".<br>"
                       + "Vous devez atteindre " + meilleurPoids + " kg.<br>"
			           + "Il vous faut pour cela prendre " + Math.round(meilleurPoids-poids) + " kg "
					   + " pour changer de catégorie et entrer dans la catégorie \"" 
					   + prochaineCategorie + "\".";
			var palierZero = meilleurPoids;
		}
		else if(imc>=18.5 && imc<=25){
			message = "Vous avez une " + corpulenceNormale + ". Ne changez rien !";
		}
		else if(imc>25 && imc<=30){
			message = "";
			//Calcul de la différence avec la catégorie en-dessous
			var bonImc = 25;
			var ecart = imcBrut-bonImc;
			var meilleurPoids = bonImc*taille*taille;
			var prochaineCategorie = corpulenceNormale;
			console.log(arrondi);
			message = "Vous êtes en " + surpoids + ".<br>"
					   + "Vous devez atteindre " + meilleurPoids + " kg.<br>"
			           + "Il vous faut donc perdre " + Math.round(poids - meilleurPoids) + " kg "
					   + " pour changer de catégorie et entrer dans la catégorie " 
					   + prochaineCategorie + ".";
			var palierUn = Math.round(meilleurPoids);
		}
		else if(imc>30 && imc<=35){
			message = "Vous êtes en " + obesiteModeree;
			
			//Calcul de la différence avec la catégorie en-dessous
			var bonImc = 30;
			var ecart = imcBrut-bonImc;
			var meilleurPoids = bonImc*taille*taille;
			var prochaineCategorie = surpoids;
			console.log(arrondi);
			message += "<br>Prochaine étape: atteindre " + meilleurPoids + " kg.<br>"
			           + "Il vous faut donc perdre " + Math.round(poids - meilleurPoids) + " kg "
					   + " pour changer de catégorie et entrer dans la catégorie " 
					   + prochaineCategorie + ".";
			var palierDeux = meilleurPoids;
		}
		else if(imc>35 && imc<=40){
			message = "Vous êtes en " + obesiteSevere;
		
			//Calcul de la différence avec la catégorie en-dessous
			var bonImc = 35;
			var ecart = imcBrut-bonImc;
			var meilleurPoids = bonImc*taille*taille;
			var prochaineCategorie = surpoids;
			console.log(arrondi);
			message += "<br>Prochaine étape: atteindre " + meilleurPoids + " kg.<br>"
			           + "Il vous faut donc perdre " + Math.round(poids - meilleurPoids) + " kg "
					   + " pour changer de catégorie et entrer dans la catégorie " 
					   + prochaineCategorie + ".";
			var pallierTrois = meilleurPoids;
		}
		else if(imc>40){
			message = "Vous êtes en " + obesiteMorbideOuMassive;
		
			//Calcul de la différence avec la catégorie en-dessous
			var bonImc = 40;
			var ecart = imcBrut-bonImc;
			var meilleurPoids = bonImc*taille*taille;
			var prochaineCategorie = "surpoids";
			console.log(arrondi);
			message += "<br>Prochaine étape: atteindre " + meilleurPoids + " kg.<br>"
			           + "Il vous faut donc perdre " + Math.round(poids - meilleurPoids) + " kg "
					   + " pour changer de catégorie et entrer dans la catégorie " 
					   + prochaineCategorie + ".";
			var pallierQuatre = meilleurPoids;
		}

		/*
		Améliorer: afficher les étapes:
		   message += "<br><br>Voici les palliers pour votre taille:<br>"
		           + "Poids minimum: " + palierZero + "<br>";
				   + corpulenceNormale + ": entre " + palierUn + " et " + palierDeux + " kg."
				   + surpoids + ": entre " + palierDeux + " et " + pallierTrois + " kg."
				   + obesiteModeree + ": entre " + pallierTrois + " et " + pallierQuatre + " kg."
				   + obesiteSevere + ": entre " + pallierQuatre
				   + " et " + palierCinq + " kg."
				   + obesiteMorbideOuMassive + " au-dessus de " + palierSix + " kg.";*/ 
				   
		//Affiche le résultat dans la page html
		selector3.innerHTML = imc.toString().replace(".", ",");//remplace le point par une virgule
		selector4.innerHTML = message;
		
	}
</script>
<body>
<html>
